делал вообще для задачи на степике у Балакирева, макросы заметил только после написания, так бы можно было от них поотталкиваться. 
принципиально не пускал нейронку)) а то больно умная не к месту. 
из-за того того, что не намеревался к этому коду возвращаться, пожертвовал изменяемостью ради наглядности (иначе бы конечно литералы бы в координатах не допустил).
